<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="css/base.css">
</head>
<body>
    
    <script src="js/three.js"></script>
    <script src="js/OrbitControls.js"></script>
    <script>
        // webGL
        let renderer = null,width=200,height=200,far=400;
        function initRenderer(){
            renderer = new THREE.WebGLRenderer({
                antilias:true ,//抗锯齿
                alpha:true
            });
            width = window.innerWidth - 17;
            height = window.innerHeight;
            renderer.setSize(width,height);
            renderer.setClearColor("#000",1);
            document.body.appendChild(renderer.domElement);
        }

        // 场景
        let scene = null;
        function initScene(){
            scene = new THREE.Scene();
        }

        // 相机
        let camera = null;
        function initCamera(){
            camera = new THREE.PerspectiveCamera(45,width/height,1,far*3);
            camera.position.set(0,0,far);
            scene.add(camera);
        }

        // 平面
        let plane = null;
        function createPlane(){
            let gemo = new THREE.ParametricGeometry(function(u,v,target){
                let x = u*10;
                let y = 0 ;
                let z = v*10;
                target.set(x,y,z);
                // return new THREE.Vector3(x,y,z);
            },8,8);
            
            // 创建法向量
            // let meshMaterial = new THREE.MeshNormalMaterial({
            //     flatShading:THREE.flatShading,
            //     transparent:true,
            //     opacity:0.9
            // })

            // 创建线框纹理
            // let wireFrameMat = new THREE.MeshBasicMaterial();
            // wireFrameMat.wireframe = true;

            // 创建模型
            // plane = THREE.SceneUtils.createMultiMaterialObject(gemo,[meshMaterial,wireFrameMat])
            let material = new THREE.MeshBasicMaterial({color:"#00ffaa"});
            plane = new THREE.Mesh(gemo,material);

            scene.add(plane);
            
            // 测试

            /* let gemo2 = new THREE.BoxGeometry(50,50,50);
            let material2 = new THREE.MeshBasicMaterial({color:"#660099"});
            let box = new THREE.Mesh(gemo2,material2);
            scene.add(box); */
        }


        function test(){
            var paraFunction = function (a, b,target) {
                var x = -5 + 5 * a;
                var y = -5 + 5 * b;
                var z = (Math.sin(a * Math.PI) + Math.sin(b * Math.PI)) * -7;

                target.set(x,y,z)

            }

            var paraGeometry = new THREE.ParametricGeometry(paraFunction, 8, 8);
            var paraMaterial = new THREE.MeshPhongMaterial();
            var paraMesh = new THREE.Mesh(paraGeometry, paraMaterial);
            scene.add(paraMesh);
        }

        // 交互
        let orbit = null;
        function initOrbitControls(){
            orbit = new THREE.OrbitControls(camera,renderer.domElement);
        }

        // 渲染
        function render(){
            renderer.render(scene,camera);
        }

        function animate(){
            orbit.update();
            render();
            requestAnimationFrame(animate);
        }

        function draw(){
            initRenderer();
            initScene();
            initCamera();

            // createPlane();
            test();

            initOrbitControls();
            
            animate();
        }

        draw();

    </script>
</body>
</html>